# CapsWriter GUI启动器使用说明

## 简介

CapsWriter GUI启动器是一个带有图形界面的客户端管理工具，提供：

- 🎙️ **客户端控制** - 启动、停止、重启CapsWriter客户端
- 📄 **实时日志** - 彩色分级日志显示
- 🔧 **系统托盘** - 可隐藏到系统托盘运行
- 📁 **配置管理** - 快速访问配置文件夹

## 文件结构

清理后保留的核心文件：

```
├── tray_gui_launcher.py       # GUI启动器主程序
├── 启动GUI.bat               # Windows批处理启动脚本
├── start_tray_silent.vbs     # VBS静默启动脚本
└── GUI启动器使用说明.md      # 本文档
```

## 启动方法

### 方法1：VBS静默启动（推荐）
```vbs
# 双击运行，完全静默启动，不显示任何命令行窗口
# GUI会直接出现，无黑色窗口闪现
start_tray_silent.vbs
```

### 方法2：批处理启动
```bash
# 双击运行，会短暂显示启动信息然后启动GUI
启动GUI.bat
```

### 方法3：直接Python启动
```bash
venv\Scripts\python.exe tray_gui_launcher.py
```

## 功能说明

### 主窗口功能

- **自动启动** - GUI启动时自动启动CapsWriter客户端
- **状态显示** - 实时显示客户端运行状态
- **控制按钮** - 启动/停止/重启/清空日志/隐藏到托盘/退出程序
- **日志显示** - 实时彩色日志，支持滚动查看
- **智能退出** - 关闭窗口或点击"退出程序"会自动停止客户端

### 系统托盘功能

- **托盘图标状态指示** - 绿色=运行中，灰色=已停止
- **单击托盘图标** - 显示/隐藏主窗口
- **右键菜单** - 完整控制选项

### 日志颜色说明

- 🔵 **蓝色** - 一般信息
- 🟢 **绿色** - 成功信息
- 🟠 **橙色** - 警告信息  
- 🔴 **红色** - 错误信息

## 环境要求

### 依赖库
```bash
# 基本GUI依赖（通常已包含在Python中）
tkinter

# 系统托盘功能依赖
pip install pystray pillow
```

### 系统要求
- **Windows 7+** 
- **Python 3.7+**
- **已配置的CapsWriter虚拟环境**

## 使用流程

1. **启动GUI** - 双击 `start_tray_silent.vbs`（推荐）或 `启动GUI.bat`
2. **自动启动客户端** - GUI启动后会自动启动CapsWriter客户端
3. **查看日志** - 在日志区域实时查看客户端状态
4. **隐藏到托盘** - 点击"隐藏到托盘"按钮（客户端继续运行）
5. **恢复窗口** - 单击系统托盘图标
6. **完全退出** - 点击"退出程序"按钮或关闭窗口（自动停止客户端并退出）

## 故障排除

### 常见问题

1. **GUI无法启动**
   ```bash
   # 检查虚拟环境
   venv\Scripts\python.exe --version
   
   # 检查依赖
   venv\Scripts\pip.exe list | grep pystray
   ```

2. **托盘图标不显示**
   - 检查Windows通知区域设置
   - 确保允许显示所有图标

3. **客户端启动失败**
   - 查看日志区域的错误信息
   - 确认 `scripts/start_client.py` 文件存在
   - 检查虚拟环境配置

### 调试模式

如需调试，在命令行中运行：
```bash
venv\Scripts\python.exe tray_gui_launcher.py
```

## 高级配置

### 开机自启动

**方法1：启动文件夹**
1. 按 `Win + R`，输入 `shell:startup`
2. 将 `start_tray_silent.vbs` 复制到启动文件夹

**方法2：任务计划程序**
1. 创建基本任务
2. 触发器设为"计算机启动时"
3. 操作选择VBS脚本路径

### 配置客户端

GUI提供快速访问配置的功能：
- 右键托盘图标 → "打开配置文件夹"
- 可编辑热词文件、配置文件等

## 技术特点

- **进程监控** - 实时监控客户端进程状态
- **异步日志** - 非阻塞的日志更新机制
- **优雅退出** - 确保进程正确停止
- **状态同步** - GUI和托盘状态实时同步
- **异常恢复** - 自动处理进程异常退出

---

**注意事项：**
- GUI启动时会自动启动CapsWriter客户端
- 关闭GUI窗口会完全退出程序并自动停止客户端
- 要保持客户端运行但隐藏窗口，请使用"隐藏到托盘"按钮
- 建议添加到开机自启动以获得最佳体验